<section class="search-hero section">
  <div class="container">
    <dr-section-header
      title="Search DocRoster specialists"
      subtitle="Blend map intelligence, filters and live availability to find the teams you need."
    >
      <div actions class="search-hero__actions" *ngIf="hasSelections()">
        <button class="button button--ghost" type="button" (click)="resetAll()">Reset filters</button>
      </div>
    </dr-section-header>
    <form class="search-hero__form" (ngSubmit)="$event.preventDefault()">
      <label class="search-hero__field">
        <span class="material-symbols-rounded" aria-hidden="true">search</span>
        <input type="search" [formControl]="searchControl" placeholder="Search by name, specialty or clinic" aria-label="Search specialists" />
        <button
          type="button"
          class="search-hero__clear"
          *ngIf="searchControl.value"
          (click)="clearSearch()"
        >
          Clear
        </button>
      </label>
    </form>
    <p class="search-hero__meta" *ngIf="(visibleCount$ | async) as count">{{ count }} specialists match your filters.</p>
  </div>
</section>

<section class="search-layout container">
  <aside class="search-layout__filters" *ngIf="filters$ | async as groups">
    <ng-container *ngFor="let group of groups">
      <div class="search-layout__filter-group">
        <dr-filter-group
          [group]="group"
          [selected]="selectionForGroup(group.id)"
          (toggled)="onToggle(group, $event)"
        ></dr-filter-group>
        <button
          type="button"
          class="search-layout__clear"
          *ngIf="selectionForGroup(group.id).length"
          (click)="clearGroup(group.id)"
        >
          Clear {{ group.title.toLowerCase() }}
        </button>
      </div>
    </ng-container>
  </aside>
  <div class="search-layout__results" *ngIf="visibleResults$ | async as results">
    <div class="search-layout__empty" *ngIf="!results.length">
      <h3>No matches yet</h3>
      <p>Adjust the filters or explore the DocRoster map to discover more pilot specialists.</p>
    </div>
    <dr-doctor-card
      *ngFor="let result of results"
      [doctor]="result.doctor"
      [clinic]="result.clinic"
      [nextAvailable]="result.nextAvailable"
      [highlightDistance]="result.distanceInMinutes"
    ></dr-doctor-card>
  </div>
</section>
