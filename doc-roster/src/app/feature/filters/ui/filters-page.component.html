<section class="filters-hero section">
  <div class="container">
    <dr-section-header
      title="Design smart filters"
      subtitle="Combine access modes, availability and language support to build reusable filter presets for DocRoster."
      badge="Configurator"
    >
      <div actions class="filters-hero__actions">
        <button class="button" type="button" (click)="resetAll()">Clear all</button>
      </div>
    </dr-section-header>

    <div class="filters-hero__selected" *ngIf="hasActiveFilters()">
      <span>Active filters</span>
      <dr-tag-list [tags]="Object.keys(selections()).flatMap((key) => selections()[key])"></dr-tag-list>
    </div>
  </div>
</section>

<section class="filters-layout container">
  <div class="filters-layout__groups" *ngIf="filters$ | async as groups">
    <ng-container *ngFor="let group of groups">
      <div class="filters-layout__group">
        <dr-filter-group
          [group]="group"
          [selected]="selections()[group.id] ?? []"
          (toggled)="onToggle(group, $event)"
        ></dr-filter-group>
        <button
          class="filters-layout__clear"
          type="button"
          *ngIf="(selections()[group.id] ?? []).length"
          (click)="clearGroup(group.id)"
        >
          Clear {{ group.title.toLowerCase() }}
        </button>
      </div>
    </ng-container>
  </div>
  <div class="filters-layout__results" *ngIf="filteredResults$ | async as results">
    <h3>Preview results</h3>
    <p>Showing {{ results.length }} matches across the pilot network.</p>
    <dr-doctor-card
      *ngFor="let result of results"
      [doctor]="result.doctor"
      [clinic]="result.clinic"
      [nextAvailable]="result.nextAvailable"
      [highlightDistance]="result.distanceInMinutes"
    ></dr-doctor-card>
  </div>
</section>
